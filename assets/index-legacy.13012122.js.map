{"version":3,"file":"index-legacy.13012122.js","sources":["../../src/i18n/index.js"],"sourcesContent":["export default class Lang {\n    constructor({save, load}) {\n        this.#save = save;\n        this.#load = load;\n    }\n\n    /**\n     * @typedef {{[key: string]: LangString}} LSProxy\n     */\n    #save;\n    #load;\n    /** @type {LSProxy} */\n    #g;\n    /** @type {LSProxy} */\n    #t;\n    /** @type {LSProxy} */\n    #e;\n    #lang;\n    #cache = new Map();\n\n    async initialize() {\n        const lang = this.#load();\n        await this.#switch(lang);\n    }\n\n    async #import(lang) {\n        if(this.#cache.has(lang))\n            return this.#cache.get(lang);\n\n        const {general, tips, error, moment} = await import(`./langs/${lang}.js`);\n\n        const ls = (data, notfind)=>{\n            const map = new Map();\n            for(const key in data)\n                map.set(key, new LangString(data[key]));\n            return new Proxy(map, {\n                get: (target, key) => {\n                    if(target.has(key))\n                        return target.get(key);\n                    if(notfind) return notfind(target, key);\n                    return new LangString(key);\n                }\n            });\n        }\n\n        const data = {\n            general: ls(general),\n            tips: ls(tips),\n            error: ls(error, target=>target.get('unknow')),\n            moment,\n        }\n\n        this.#cache.set(lang, data);\n        return data;\n    }\n\n    async #switch(lang) {\n        const {general, tips, error, moment} = await this.#import(lang);\n        this.#g = general;\n        this.#t = tips;\n        this.#e = error;\n        this.#lang = lang;\n        $moment.updateLocale(lang, moment);\n        $moment.locale(lang);\n    }\n\n    async switch(lang) {\n        await this.#switch(lang);\n        this.#save(lang);\n    }\n\n    get lang() {return this.#lang;}\n\n    /** @readonly */\n    get general() {return this.#g;}\n    /** @readonly */\n    get g() {return this.#g;}\n    /** @readonly */\n    get tips() {return this.#t;}\n    /** @readonly */\n    get t() {return this.#t;}\n    /** @readonly */\n    get error() {return this.#e;}\n    /** @readonly */\n    get e() {return this.#e;}\n\n    f(str, values, ...args) {\n        return this.format(str, values, ...args);\n    }\n\n    format(str, values, ...args) {\n        return $utils.format(\n            this.#g[str] || str,\n            values, ...args\n        ) || '';\n    }\n}\n\nclass LangString extends String {\n    format(values, ...args) {\n        return $utils.format(this, values, ...args);\n    }\n\n    f(values, ...args) {\n        return this.format(values, ...args);\n    }\n}"],"names":["Lang","_ref","save","load","_classCallCheck","_classPrivateMethodInitSpec","_switch","this","_import","_classPrivateFieldInitSpec","_save","writable","value","_load","_g","_t","_e","_lang","_cache","Map","_classPrivateFieldSet","_initialize","_createClass","key","_asyncToGenerator","_regeneratorRuntime","mark","_callee","lang","wrap","_context","prev","next","_classPrivateFieldGet","call","_classPrivateMethodGet","_switch2","stop","initialize","apply","arguments","_switch3","_x","toString","_ref2","_callee2","_context2","_x2","get","str","values","_len","length","args","Array","_key","format","concat","_$utils","_len2","_key2","$utils","_import2","_x3","_import3","_callee3","_yield$__variableDyna","general","tips","error","moment","ls","data","_callee3$","_context3","has","abrupt","__variableDynamicImportRuntimeHelper","Object","assign","__vitePreload","module","import","sent","notfind","map","set","LangString","Proxy","target","_x4","_switch4","_callee4","_yield$_classPrivateM","_context4","$moment","updateLocale","locale","exports","_String","_inherits","_super","_createSuper","_$utils2","_len3","_key3","_len4","_key4","_wrapNativeSuper","String"],"mappings":"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"}